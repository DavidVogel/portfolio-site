\doxysection{processor\+\_\+router.\+h}
\hypertarget{processor__router_8h_source}{}\label{processor__router_8h_source}\index{/Users/davidvogel/repos/VitalHelp/src/synthesis/framework/processor\_router.h@{/Users/davidvogel/repos/VitalHelp/src/synthesis/framework/processor\_router.h}}
\mbox{\hyperlink{processor__router_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{processor_8h}{processor.h}}"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{circular__queue_8h}{circular\_queue.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <set>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacevital}{vital}}\ \{}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \textcolor{keyword}{class\ }Feedback;}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00034\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classvital_1_1_processor_router}{ProcessorRouter}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}\ \{}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_processor_router_a43ee925ced978ace8ec567faac893add}{ProcessorRouter}}(\textcolor{keywordtype}{int}\ num\_inputs\ =\ 0,\ \textcolor{keywordtype}{int}\ num\_outputs\ =\ 0,\ \textcolor{keywordtype}{bool}\ control\_rate\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00048\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_processor_router_a43ee925ced978ace8ec567faac893add}{ProcessorRouter}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classvital_1_1_processor_router}{ProcessorRouter}}\&\ original);}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00053\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classvital_1_1_processor_router_a203c2bc185de31720f97cc5e244e149d}{\string~ProcessorRouter}}();}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00059\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ \mbox{\hyperlink{classvital_1_1_processor_router_a1451035228a588d309dd1eca909ca6d3}{clone}}()\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classvital_1_1_processor_router_a43ee925ced978ace8ec567faac893add}{ProcessorRouter}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00070\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_aeb03f0b2e5c2249dd065f26b8b3f1866}{process}}(\textcolor{keywordtype}{int}\ num\_samples)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00075\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_a6ebd94c5d73a14a1a20b67ddf60125ee}{init}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00083\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_a7e0dd6e0873082d4883a3fa1e6e451a0}{setSampleRate}}(\textcolor{keywordtype}{int}\ sample\_rate)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00091\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_a4c88954b0d0baec70f87485772d0c228}{setOversampleAmount}}(\textcolor{keywordtype}{int}\ oversample)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00100\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_af5322ce72a1e53f6d81ce917f07427e7}{addProcessor}}(\mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ processor);}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00106\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_acd338716e49f52c83662951b22ed012b}{addProcessorRealTime}}(\mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ processor);}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00112\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_a8bc90b699c1ec299b060ed0df32f476c}{addIdleProcessor}}(\mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ processor);}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_a2e2a39dff7f95f2faee9421b87133a4f}{removeProcessor}}(\mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ processor);}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \ \ \textcolor{comment}{//\ Any\ time\ new\ dependencies\ are\ added\ into\ the\ ProcessorRouter\ graph,\ we}}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \textcolor{comment}{//\ should\ call\ \_connect\_\ on\ the\ destination\ Processor\ and\ source\ Output.}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_ad172a585ce6ed81b9817f400b4f8e2ee}{connect}}(\mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ destination,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structvital_1_1_output}{Output}}*\ source,\ \textcolor{keywordtype}{int}\ index);}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00137\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_a2c272134f228096aff853f46c0f5cac6}{disconnect}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ destination,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structvital_1_1_output}{Output}}*\ source);}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00145\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classvital_1_1_processor_router_a44f998b01ec090f5a071efbb19dbd75a}{isDownstream}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ first,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ second)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00153\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classvital_1_1_processor_router_a8d323f7284f5980af0575d09de995ef0}{areOrdered}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ first,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ second)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classvital_1_1_processor_a6109203f5da8f0c3a7413db829e13381}{isPolyphonic}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ processor)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00166\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classvital_1_1_processor_router}{ProcessorRouter}}*\ \mbox{\hyperlink{classvital_1_1_processor_router_a737c2d4614b288a18bfda203f23fb04f}{getMonoRouter}}();}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00172\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classvital_1_1_processor_router}{ProcessorRouter}}*\ \mbox{\hyperlink{classvital_1_1_processor_router_a3fa90cbfd166bd59948cfb9a0dd66bc1}{getPolyRouter}}();}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_ab064299dac2dfea05f18aeb91c5e22f7}{resetFeedbacks}}(\mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ reset\_mask);}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \textcolor{comment}{//\ When\ we\ create\ a\ cycle\ into\ the\ ProcessorRouter\ graph,\ we\ must\ insert}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \textcolor{comment}{//\ a\ Feedback\ node\ and\ add\ it\ here.}}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_a57792f6f08a068cdade56ca571b78e8e}{addFeedback}}(\mbox{\hyperlink{classvital_1_1_feedback}{Feedback}}*\ feedback);}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00193\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_a6c80c8234c2dded315fb62415db7ca26}{removeFeedback}}(\mbox{\hyperlink{classvital_1_1_feedback}{Feedback}}*\ feedback);}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \ \ \ \ \textcolor{comment}{//\ Makes\ sure\ \_processor\_\ runs\ in\ a\ topologically\ sorted\ order\ in}}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \textcolor{comment}{//\ relation\ to\ all\ other\ Processors\ in\ \_this\_.}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_acbde70124da8d2bf06b9ea3d6412211b}{reorder}}(\mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ processor);}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \ \ \textcolor{comment}{//\ Ensures\ our\ local\ copies\ of\ all\ processors\ and\ feedback\ processors\ match\ the\ master\ order.}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_a064f6bdad96043512fd705a9a017c7a3}{updateAllProcessors}}();}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00213\ \ \ \ \ \ \ \mbox{\hyperlink{common_8h_ae8c57c7218a376f10cbdf0e50f1189ee}{force\_inline}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classvital_1_1_processor_router_acc4d83926132b0f626c41aa0f255bfa6}{shouldUpdate}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classvital_1_1_processor_router_a18ae154ff39a2b8656b90779ab8baa50}{local\_changes\_}}\ !=\ *\mbox{\hyperlink{classvital_1_1_processor_router_a47473325d367640a685cbdafece68619}{global\_changes\_}};\ \}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \ \ \ \ \textcolor{comment}{//\ Will\ create\ local\ copies\ of\ added\ processors.}}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_a8ae875714d516809d6f9122201ac7b78}{createAddedProcessors}}();}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \ \ \textcolor{comment}{//\ Will\ delete\ local\ copies\ of\ removed\ processors.}}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_a266316372e5c54e7210aac8d4f2c207f}{deleteRemovedProcessors}}();}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ ancestor\ of\ \_processor\_\ which\ is\ a\ child\ of\ \_this\_.}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \textcolor{comment}{//\ Returns\ null\ if\ \_processor\_\ is\ not\ a\ descendant\ of\ \_this\_.}}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ \mbox{\hyperlink{classvital_1_1_processor_router_aed399a6457c7206cf35d3c575b9d21d3}{getContext}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ processor)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00240\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_processor_router_ae9d882ba4884aad6e011488177885a56}{getDependencies}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ processor)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \ \ \ \ \textcolor{comment}{//\ Returns\ the\ processor\ for\ this\ voice\ from\ the\ globally\ created\ one.}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ \mbox{\hyperlink{classvital_1_1_processor_router_af1221aabafb55e72099c46e094b75f72}{getLocalProcessor}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}*\ global\_processor);}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ \ \ std::shared\_ptr<CircularQueue<Processor*>>\ \mbox{\hyperlink{classvital_1_1_processor_router_a80b0f439ed2a3395b7368e6e6e08be5a}{global\_order\_}};\ \ \ \ \ \ \ }
\DoxyCodeLine{00251\ \ \ \ \ \ \ std::shared\_ptr<CircularQueue<Processor*>>\ \mbox{\hyperlink{classvital_1_1_processor_router_adb3133fc9539fc2f3bbaef89d1ade304}{global\_reorder\_}};\ \ \ \ \ }
\DoxyCodeLine{00252\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_circular_queue}{CircularQueue<Processor*>}}\ \mbox{\hyperlink{classvital_1_1_processor_router_ad7b50fb0c85a4bfb4249accd79c53f1e}{local\_order\_}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \ \ \ \ std::map<const\ Processor*,\ std::pair<int,\ std::unique\_ptr<Processor>>>\ \mbox{\hyperlink{classvital_1_1_processor_router_a35a7167247ff12bb042f9224d48534a6}{processors\_}};\ }
\DoxyCodeLine{00255\ \ \ \ \ \ \ std::map<const\ Processor*,\ std::unique\_ptr<Processor>>\ \mbox{\hyperlink{classvital_1_1_processor_router_a99f43b9da34a29911ed8df8f8839c1a1}{idle\_processors\_}};\ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \ \ \ \ std::shared\_ptr<std::vector<const\ Feedback*>>\ \mbox{\hyperlink{classvital_1_1_processor_router_a7f64d093205c346eb27ffa0ce2b4a8c7}{global\_feedback\_order\_}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00258\ \ \ \ \ \ \ std::vector<Feedback*>\ \mbox{\hyperlink{classvital_1_1_processor_router_a87be28861bfe6cf768ee244e4f7877be}{local\_feedback\_order\_}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00259\ \ \ \ \ \ \ std::map<const\ Processor*,\ std::pair<int,\ std::unique\_ptr<Feedback>>>\ \mbox{\hyperlink{classvital_1_1_processor_router_a064ca063a40b70ac3bd913f90cfb5b26}{feedback\_processors\_}};\ }
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \ \ \ \ std::shared\_ptr<int>\ \mbox{\hyperlink{classvital_1_1_processor_router_a47473325d367640a685cbdafece68619}{global\_changes\_}};\ \ }
\DoxyCodeLine{00262\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classvital_1_1_processor_router_a18ae154ff39a2b8656b90779ab8baa50}{local\_changes\_}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ \ \ \ \ std::shared\_ptr<CircularQueue<const\ Processor*>>\ \mbox{\hyperlink{classvital_1_1_processor_router_a0af6729c08f07e71c1d636a8318f2944}{dependencies\_}};\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00265\ \ \ \ \ \ \ std::shared\_ptr<CircularQueue<const\ Processor*>>\ \mbox{\hyperlink{classvital_1_1_processor_router_a9181b40895e99a7550efb14c6fdcf3e9}{dependencies\_visited\_}};\ }
\DoxyCodeLine{00266\ \ \ \ \ \ \ std::shared\_ptr<CircularQueue<const\ Processor*>>\ \mbox{\hyperlink{classvital_1_1_processor_router_a96a105ef8c10efa5132b6c1cbdcdf196}{dependency\_inputs\_}};\ \ \ \ \ }
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \ \ \ \ JUCE\_LEAK\_DETECTOR(\mbox{\hyperlink{classvital_1_1_processor_router}{ProcessorRouter}})}
\DoxyCodeLine{00269\ \ \ \};}
\DoxyCodeLine{00270\ \}\ \textcolor{comment}{//\ namespace\ vital}}
\DoxyCodeLine{00271\ }

\end{DoxyCode}
