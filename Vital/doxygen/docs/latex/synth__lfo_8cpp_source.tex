\doxysection{synth\+\_\+lfo.\+cpp}
\hypertarget{synth__lfo_8cpp_source}{}\label{synth__lfo_8cpp_source}\index{/Users/davidvogel/repos/VitalHelp/src/synthesis/modulators/synth\_lfo.cpp@{/Users/davidvogel/repos/VitalHelp/src/synthesis/modulators/synth\_lfo.cpp}}
\mbox{\hyperlink{synth__lfo_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{synth__lfo_8h}{synth\_lfo.h}}"{}}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{common_8h}{common.h}}"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{line__generator_8h}{line\_generator.h}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{synth__constants_8h}{synth\_constants.h}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{utils_8h}{utils.h}}"{}}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacevital}{vital}}\ \{}
\DoxyCodeLine{00011\ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_adc06fc3726c6181f23bf320445aea714}{SynthLfo::SynthLfo}}(\mbox{\hyperlink{class_line_generator}{LineGenerator}}*\ source)\ :\ \mbox{\hyperlink{classvital_1_1_processor}{Processor}}(kNumInputs,\ kNumOutputs),\ source\_(source)\ \{}
\DoxyCodeLine{00012\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ae36c55e17ebfab423aa2867c18692b6f}{was\_control\_rate\_}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00013\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a461d405497bd529d79f2dbac49770a02}{sync\_seconds\_}}\ =\ std::make\_shared<double>();}
\DoxyCodeLine{00014\ \ \ \ \ *\mbox{\hyperlink{classvital_1_1_synth_lfo_a461d405497bd529d79f2dbac49770a02}{sync\_seconds\_}}\ =\ 0;}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a525365c768b97a3a7303df00686462f8}{trigger\_sample\_}}\ =\ 0;}
\DoxyCodeLine{00017\ \ \ \}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \ \ \mbox{\hyperlink{common_8h_ae8c57c7218a376f10cbdf0e50f1189ee}{force\_inline}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a05b435039f626a51d50f120c492ebdf7}{SynthLfo::processTrigger}}()\ \{}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keywordtype}{int}\ sync\_type\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a61ddd9fa63f13f4e623d50667f1891dd}{kSyncType}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)[0];}
\DoxyCodeLine{00027\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ reset\_mask\ =\ \mbox{\hyperlink{classvital_1_1_processor_a7fed5dc3ae95e104c71f7ce7f570fab4}{getResetMask}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3afaa4337a97069200731696d42c7a2956}{kNoteTrigger}});}
\DoxyCodeLine{00028\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ release\_mask\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a010c388887f81f2522ae185236a96ff5}{getReleaseMask}}();}
\DoxyCodeLine{00029\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a87d7df1c91650fe8e4d8ab861cd229dc}{held\_mask\_}}\ =\ (\mbox{\hyperlink{classvital_1_1_synth_lfo_a87d7df1c91650fe8e4d8ab861cd229dc}{held\_mask\_}}\ |\ reset\_mask)\ \&\ \string~release\_mask;}
\DoxyCodeLine{00030\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_int}}\ trigger\_offset\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3afaa4337a97069200731696d42c7a2956}{kNoteTrigger}})-\/>\mbox{\hyperlink{structvital_1_1_input_adc691b9fd0f8c8c79c2a40e9e3314eaf}{source}}-\/>\mbox{\hyperlink{structvital_1_1_output_a295fb3938d4bd8f9a4029c1e617230f8}{trigger\_offset}};}
\DoxyCodeLine{00031\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a525365c768b97a3a7303df00686462f8}{trigger\_sample\_}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a525365c768b97a3a7303df00686462f8}{trigger\_sample\_}},\ trigger\_offset,\ (reset\_mask\ |\ release\_mask));}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}},\ 0.0f,\ reset\_mask);}
\DoxyCodeLine{00034\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}},\ 0.0f,\ reset\_mask);}
\DoxyCodeLine{00035\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}},\ 0.0f,\ reset\_mask);}
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}},\ 0.0f,\ reset\_mask);}
\DoxyCodeLine{00037\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}},\ 0.0f,\ reset\_mask);}
\DoxyCodeLine{00038\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}},\ 0.0f,\ reset\_mask);}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ trigger\_delay\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a29ec8af38789c39515d4b43ee42e9de6}{utils::toFloat}}(trigger\_offset)\ *\ (1.0f\ /\ \mbox{\hyperlink{classvital_1_1_processor_a70822ba483c1a6528f1809621befd4b8}{getSampleRate}}());}
\DoxyCodeLine{00041\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a0ea2c63fff1ab701676dff4880d6561b}{trigger\_delay\_}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a0ea2c63fff1ab701676dff4880d6561b}{trigger\_delay\_}},\ trigger\_delay,\ reset\_mask);}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordflow}{if}\ (reset\_mask.\mbox{\hyperlink{structvital_1_1poly__int_a2fab54be2efa9a05ed842b91e4bad62d}{anyMask}}())\ \{}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ frequency\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a5c128d04b5aa3ddc38fd5c7f2be27c4b}{kFrequency}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5acea765ee0eb550e790ce42deda95a2d36f9}{kSync}})\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ sync\ mode,\ align\ offset\ with\ the\ external\ time\ reference.}}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ sync\_phase\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a70d1632b7ff25265d67a5b886c5c7410}{utils::getCycleOffsetFromSeconds}}(*\mbox{\hyperlink{classvital_1_1_synth_lfo_a461d405497bd529d79f2dbac49770a02}{sync\_seconds\_}},\ frequency);}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}},\ sync\_phase,\ reset\_mask);}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}},\ sync\_phase,\ reset\_mask);}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ non-\/sync,\ simply\ reset\ offset\ to\ zero\ (or\ adjust\ by\ the\ triggered\ sample\ offset).}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}},\ 0.0f,\ reset\_mask);}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ sample\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a29ec8af38789c39515d4b43ee42e9de6}{utils::toFloat}}(trigger\_offset)\ \&\ reset\_mask;}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ offset\_start\ =\ frequency\ *\ sample\_offset\ *\ (1.0f\ /\ \mbox{\hyperlink{classvital_1_1_processor_a70822ba483c1a6528f1809621befd4b8}{getSampleRate}}());}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}},\ -\/offset\_start,\ reset\_mask);}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00060\ \ \ \ \ \}}
\DoxyCodeLine{00061\ \ \ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a761aa70deb09f68ce37bd7e66fe490b1}{SynthLfo::processControlRate}}(\textcolor{keywordtype}{int}\ num\_samples)\ \{}
\DoxyCodeLine{00070\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a4dcdfb302843d7d6f232d419cafc0582}{kDelay}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordtype}{float}\ tick\_time\ =\ 1.0f\ /\ \mbox{\hyperlink{classvital_1_1_processor_a70822ba483c1a6528f1809621befd4b8}{getSampleRate}}();}
\DoxyCodeLine{00073\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ time\_passed\ =\ tick\_time\ *\ num\_samples;}
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}}\ +=\ time\_passed;}
\DoxyCodeLine{00075\ \ \ \ \ time\_passed\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a13a19cf68aa11afa58de96f14442003a}{utils::clamp}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}}\ -\/\ delay\_time,\ 0.0f,\ time\_passed);}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ stereo\_phase\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3aa40c2e85855811725a3ab1d41e756617}{kStereoPhase}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00078\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ phase\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a009ee6d6a034db70afa98bf3513867a0}{kPhase}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ +\ stereo\_phase\ *\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}(0.5f,\ -\/0.5f);}
\DoxyCodeLine{00079\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ frequency\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a5c128d04b5aa3ddc38fd5c7f2be27c4b}{kFrequency}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00080\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_offset\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}};}
\DoxyCodeLine{00081\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ +=\ frequency\ *\ time\_passed;}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ phased\_offset;}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{int}\ sync\_type\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a61ddd9fa63f13f4e623d50667f1891dd}{kSyncType}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)[0];}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{comment}{//\ Apply\ logic\ based\ on\ sync\ type}}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5acea303458fc9c7cca09b5e9a9c9a63775af}{kEnvelope}})\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}},\ 1.0f);}
\DoxyCodeLine{00088\ \ \ \ \ \ \ phased\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(current\_offset\ +\ phase,\ 1.0f);}
\DoxyCodeLine{00089\ \ \ \ \ \}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5acea3e4621da38a094b89a53e82287a56751}{kSustainEnvelope}})\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}},\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(1.0f,\ phase,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a87d7df1c91650fe8e4d8ab861cd229dc}{held\_mask\_}}));}
\DoxyCodeLine{00092\ \ \ \ \ \ \ phased\_offset\ =\ current\_offset;}
\DoxyCodeLine{00093\ \ \ \ \ \}}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5aceae6d13fd29435f2a82282c52f25fa2834}{kTrigger}}\ ||\ sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5acea765ee0eb550e790ce42deda95a2d36f9}{kSync}})\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a02cebee05a6ccafbce870a1a18ae0d04}{utils::mod}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}});}
\DoxyCodeLine{00096\ \ \ \ \ \ \ phased\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a02cebee05a6ccafbce870a1a18ae0d04}{utils::mod}}(current\_offset\ +\ phase);}
\DoxyCodeLine{00097\ \ \ \ \ \}}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5aceaca607d5cc7f3a8b9f0c3dcd0d3ad1023}{kLoopPoint}})\ \{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ over\ =\ \mbox{\hyperlink{structvital_1_1poly__float_a1bea6a867419c6ea42ffc195f35ec3bc}{poly\_float::greaterThanOrEqual}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}},\ 1.0f);}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}},}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ -\/\ 1.0f\ +\ phase,\ over);}
\DoxyCodeLine{00102\ \ \ \ \ \ \ phased\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(current\_offset,\ 1.0f);}
\DoxyCodeLine{00103\ \ \ \ \ \}}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5aceaec4e192355f4257ad98e459f4a48e62d}{kLoopHold}})\ \{}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ over\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a87d7df1c91650fe8e4d8ab861cd229dc}{held\_mask\_}}\ \&\ \mbox{\hyperlink{structvital_1_1poly__float_a1bea6a867419c6ea42ffc195f35ec3bc}{poly\_float::greaterThanOrEqual}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}},\ phase);}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(\mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}},}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ -\/\ phase,\ over),\ 1.0f);}
\DoxyCodeLine{00108\ \ \ \ \ \ \ phased\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(current\_offset,\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(current\_offset,\ phase),\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a87d7df1c91650fe8e4d8ab861cd229dc}{held\_mask\_}});}
\DoxyCodeLine{00109\ \ \ \ \ \}}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a078f4b6786ff8e332c963f33df8993bf}{kFade}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_increase\ =\ time\_passed\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(\mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(tick\_time,\ time\_passed),\ fade\_time);}
\DoxyCodeLine{00113\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}}\ +\ fade\_increase,\ 1.0f);}
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}},}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.0f,\ \mbox{\hyperlink{structvital_1_1poly__float_a62737c049e0fe6348bd3f5d2fe4bf02a}{poly\_float::equal}}(fade\_time,\ 0.0f));}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aaf601c51856a2a33ecf3dc39f2875271}{getValueAtPhase}}(phased\_offset);}
\DoxyCodeLine{00118\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ result;}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a0d8f679e6a0a8e797e444dace8c9161d}{kSmoothMode}})-\/>at(0)[0])\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \textcolor{comment}{//\ Smoothing\ the\ output\ value\ over\ time\ using\ exponential\ decay\ based\ on\ half-\/life.}}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ half\_life\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a40ab1fecfca449df22d138b4193845c1}{kSmoothTime}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ *\ \mbox{\hyperlink{classvital_1_1_synth_lfo_af1f7af59ef94c1ad0536939356a37b04}{kHalfLifeRatio}};}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ smooth\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_afe451ece04ecb9be82648c49c4e27e7b}{poly\_float::greaterThan}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ exponent\ =\ -\/time\_passed\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ ratio\ =\ \mbox{\hyperlink{namespacevital_1_1futils_a4723d7c95b3cd4097755659bf317bb98}{futils::exp2}}(exponent);}
\DoxyCodeLine{00125\ \ \ \ \ \ \ ratio\ =\ ratio\ \&\ smooth\_mask;}
\DoxyCodeLine{00126\ \ \ \ \ \ \ result\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ae1ebe307e6064bb3d3bf55a2258d308a}{utils::interpolate}}(value,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}},\ ratio);}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}}\ =\ result;}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ no\ smoothing,\ interpolate\ based\ on\ fade\ amplitude\ from\ the\ start\ phase.}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ start\_value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aaf601c51856a2a33ecf3dc39f2875271}{getValueAtPhase}}(phase);}
\DoxyCodeLine{00132\ \ \ \ \ \ \ result\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ae1ebe307e6064bb3d3bf55a2258d308a}{utils::interpolate}}(start\_value,\ value,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}});}
\DoxyCodeLine{00133\ \ \ \ \ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \ \ result\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a13a19cf68aa11afa58de96f14442003a}{utils::clamp}}(result,\ -\/1.0f,\ 1.0f);}
\DoxyCodeLine{00136\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_processor_ab09651265a7270548b77e99b1316fde0}{output}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a3f38fe80d632b575a18978456d82b1bfa7938401f18413f9725ea840912e8ba48}{kValue}})-\/>\mbox{\hyperlink{structvital_1_1_output_add4bada660da96ee68e1645aaefc9f46}{trigger\_value}}\ =\ result;}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classvital_1_1_processor_a7c412df809f6c84fe54bdd977681fd9a}{isControlRate}}())}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_processor_ab09651265a7270548b77e99b1316fde0}{output}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a3f38fe80d632b575a18978456d82b1bfa7938401f18413f9725ea840912e8ba48}{kValue}})-\/>\mbox{\hyperlink{structvital_1_1_output_a1bc2c3a75ee0525ecbfb24fc841b1fe4}{buffer}}[0]\ =\ result;}
\DoxyCodeLine{00139\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_processor_ab09651265a7270548b77e99b1316fde0}{output}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a3f38fe80d632b575a18978456d82b1bfac4e4a6341414bac59c762e5bc705bdbe}{kOscPhase}})-\/>\mbox{\hyperlink{structvital_1_1_output_a1bc2c3a75ee0525ecbfb24fc841b1fe4}{buffer}}[0]\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a2a2de508f71ee1a987ec75a77b7129b0}{utils::encodePhaseAndVoice}}(phased\_offset,\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3aeea02e5e2586399125a0206c86ca26ed}{kNoteCount}})-\/>at(0));}
\DoxyCodeLine{00140\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_processor_ab09651265a7270548b77e99b1316fde0}{output}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a3f38fe80d632b575a18978456d82b1bfac99f38d8ae36f32b68c986b9ab5c3bce}{kOscFrequency}})-\/>\mbox{\hyperlink{structvital_1_1_output_a1bc2c3a75ee0525ecbfb24fc841b1fe4}{buffer}}[0]\ =\ frequency;}
\DoxyCodeLine{00141\ \ \ \}}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00144\ \textcolor{comment}{\ \ *\ The\ following\ audio-\/rate\ methods\ (processAudioRateEnvelope,\ processAudioRateSustainEnvelope,\ etc.)}}
\DoxyCodeLine{00145\ \textcolor{comment}{\ \ *\ follow\ a\ similar\ pattern:\ they\ integrate\ the\ phase\ and\ offset\ over\ each\ sample,}}
\DoxyCodeLine{00146\ \textcolor{comment}{\ \ *\ apply\ smoothing,\ fades,\ and\ delays,\ and\ write\ out\ a\ processed\ buffer\ of\ LFO\ values.}}
\DoxyCodeLine{00147\ \textcolor{comment}{\ \ *}}
\DoxyCodeLine{00148\ \textcolor{comment}{\ \ *\ They\ each\ handle\ a\ different\ sync\ mode,\ applying\ that\ mode's\ rules\ for}}
\DoxyCodeLine{00149\ \textcolor{comment}{\ \ *\ looping,\ holding,\ or\ envelope\ stopping,\ and\ produce\ a\ continuous\ buffer\ of\ LFO\ samples.}}
\DoxyCodeLine{00150\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00151\ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ \mbox{\hyperlink{classvital_1_1_synth_lfo_ada21195dee79f216ee82d7f2cd8b8c48}{SynthLfo::processAudioRateEnvelope}}(\textcolor{keywordtype}{int}\ num\_samples,\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_phase,}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_offset,\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delta\_offset)\ \{}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keywordtype}{int}\ lfo\_resolution\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aa356af7e0087e77a572795346bf83dd5}{source\_}}-\/>\mbox{\hyperlink{class_line_generator_ab915f3ee0e673ae1aeabdf39880e2af0}{resolution}}();}
\DoxyCodeLine{00154\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ resolution\ =\ lfo\_resolution;}
\DoxyCodeLine{00155\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_int}}\ max\_index\ =\ lfo\_resolution\ -\/\ 1;}
\DoxyCodeLine{00156\ \ \ \ \ \mbox{\hyperlink{namespacevital_afcc17475a10ef776bbd2f11b64c1ddfb}{mono\_float}}*\ lfo\_buffer\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aa356af7e0087e77a572795346bf83dd5}{source\_}}-\/>\mbox{\hyperlink{class_line_generator_ae1d135bc4fb25f20fc8cd642bafef316}{getCubicInterpolationBuffer}}();}
\DoxyCodeLine{00157\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delta\_phase\ =\ (\mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac4c286d0ef374067a57ad0de8a39ceb3}{phase}}\ -\/\ current\_phase)\ *\ (1.0f\ /\ num\_samples);}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a078f4b6786ff8e332c963f33df8993bf}{kFade}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00160\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a4dcdfb302843d7d6f232d419cafc0582}{kDelay}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ +\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a0ea2c63fff1ab701676dff4880d6561b}{trigger\_delay\_}};}
\DoxyCodeLine{00161\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\_passed\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}};}
\DoxyCodeLine{00162\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_amplitude\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}};}
\DoxyCodeLine{00163\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ tick\_time\ =\ 1.0f\ /\ \mbox{\hyperlink{classvital_1_1_processor_a70822ba483c1a6528f1809621befd4b8}{getSampleRate}}();}
\DoxyCodeLine{00164\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_increase\ =\ tick\_time\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(tick\_time,\ fade\_time);}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ smooth\_mult\ =\ 0.0f;}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a0d8f679e6a0a8e797e444dace8c9161d}{kSmoothMode}})-\/>at(0)[0])\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ half\_life\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a40ab1fecfca449df22d138b4193845c1}{kSmoothTime}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ *\ \mbox{\hyperlink{classvital_1_1_synth_lfo_af1f7af59ef94c1ad0536939356a37b04}{kHalfLifeRatio}};}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ smooth\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_afe451ece04ecb9be82648c49c4e27e7b}{poly\_float::greaterThan}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ exponent\ =\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}(-\/tick\_time)\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00171\ \ \ \ \ \ \ smooth\_mult\ =\ \mbox{\hyperlink{namespacevital_1_1futils_a4723d7c95b3cd4097755659bf317bb98}{futils::exp2}}(exponent);}
\DoxyCodeLine{00172\ \ \ \ \ \ \ smooth\_mult\ =\ smooth\_mult\ \&\ smooth\_mask;}
\DoxyCodeLine{00173\ \ \ \ \ \ \ current\_amplitude\ =\ 1.0f;}
\DoxyCodeLine{00174\ \ \ \ \ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}*\ dest\ =\ \mbox{\hyperlink{classvital_1_1_processor_ab09651265a7270548b77e99b1316fde0}{output}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a3f38fe80d632b575a18978456d82b1bfa7938401f18413f9725ea840912e8ba48}{kValue}})-\/>\mbox{\hyperlink{structvital_1_1_output_a1bc2c3a75ee0525ecbfb24fc841b1fe4}{buffer}};}
\DoxyCodeLine{00177\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ phased\_offset\ =\ 0.0f;}
\DoxyCodeLine{00178\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}};}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_samples;\ ++i)\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ delay\_time\_passed\ +=\ tick\_time;}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ past\_delay\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_a1bea6a867419c6ea42ffc195f35ec3bc}{poly\_float::greaterThanOrEqual}}(delay\_time\_passed,\ delay\_time);}
\DoxyCodeLine{00183\ \ \ \ \ \ \ current\_amplitude\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a13a19cf68aa11afa58de96f14442003a}{utils::clamp}}(current\_amplitude\ +\ (fade\_increase\ \&\ past\_delay\_mask),\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00184\ \ \ \ \ \ \ phased\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(current\_offset\ +\ current\_phase,\ 1.0f);}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aaf601c51856a2a33ecf3dc39f2875271}{getValueAtPhase}}(lfo\_buffer,\ resolution,\ max\_index,\ phased\_offset);}
\DoxyCodeLine{00186\ \ \ \ \ \ \ current\_value\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ae1ebe307e6064bb3d3bf55a2258d308a}{utils::interpolate}}(value,\ current\_value,\ smooth\_mult);}
\DoxyCodeLine{00187\ \ \ \ \ \ \ dest[i]\ =\ current\_amplitude\ *\ current\_value;}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \ \ \ \ current\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(current\_offset\ +\ (delta\_offset\ \&\ past\_delay\_mask),\ 1.0f);}
\DoxyCodeLine{00190\ \ \ \ \ \ \ current\_phase\ +=\ delta\_phase;}
\DoxyCodeLine{00191\ \ \ \ \ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}}\ =\ current\_value;}
\DoxyCodeLine{00194\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}}\ =\ current\_amplitude;}
\DoxyCodeLine{00195\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}}\ =\ delay\_time\_passed;}
\DoxyCodeLine{00196\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(current\_offset,\ 1.0f);}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{keywordflow}{return}\ phased\_offset;}
\DoxyCodeLine{00198\ \ \ \}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a08279a0a2065c114057fe6ac34d84d02}{SynthLfo::processAudioRateSustainEnvelope}}(\textcolor{keywordtype}{int}\ num\_samples,\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_phase,}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_offset,\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delta\_offset)\ \{}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordtype}{int}\ lfo\_resolution\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aa356af7e0087e77a572795346bf83dd5}{source\_}}-\/>\mbox{\hyperlink{class_line_generator_ab915f3ee0e673ae1aeabdf39880e2af0}{resolution}}();}
\DoxyCodeLine{00203\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ resolution\ =\ lfo\_resolution;}
\DoxyCodeLine{00204\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_int}}\ max\_index\ =\ lfo\_resolution\ -\/\ 1;}
\DoxyCodeLine{00205\ \ \ \ \ \mbox{\hyperlink{namespacevital_afcc17475a10ef776bbd2f11b64c1ddfb}{mono\_float}}*\ lfo\_buffer\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aa356af7e0087e77a572795346bf83dd5}{source\_}}-\/>\mbox{\hyperlink{class_line_generator_ae1d135bc4fb25f20fc8cd642bafef316}{getCubicInterpolationBuffer}}();}
\DoxyCodeLine{00206\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delta\_phase\ =\ (\mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac4c286d0ef374067a57ad0de8a39ceb3}{phase}}\ -\/\ current\_phase)\ *\ (1.0f\ /\ num\_samples);}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a078f4b6786ff8e332c963f33df8993bf}{kFade}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00209\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a4dcdfb302843d7d6f232d419cafc0582}{kDelay}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ +\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a0ea2c63fff1ab701676dff4880d6561b}{trigger\_delay\_}};}
\DoxyCodeLine{00210\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\_passed\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}};}
\DoxyCodeLine{00211\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_amplitude\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}};}
\DoxyCodeLine{00212\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ tick\_time\ =\ 1.0f\ /\ \mbox{\hyperlink{classvital_1_1_processor_a70822ba483c1a6528f1809621befd4b8}{getSampleRate}}();}
\DoxyCodeLine{00213\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_increase\ =\ tick\_time\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(tick\_time,\ fade\_time);}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ smooth\_mult\ =\ 0.0f;}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a0d8f679e6a0a8e797e444dace8c9161d}{kSmoothMode}})-\/>at(0)[0])\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ half\_life\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a40ab1fecfca449df22d138b4193845c1}{kSmoothTime}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ *\ \mbox{\hyperlink{classvital_1_1_synth_lfo_af1f7af59ef94c1ad0536939356a37b04}{kHalfLifeRatio}};}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ smooth\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_afe451ece04ecb9be82648c49c4e27e7b}{poly\_float::greaterThan}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ exponent\ =\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}(-\/tick\_time)\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00220\ \ \ \ \ \ \ smooth\_mult\ =\ \mbox{\hyperlink{namespacevital_1_1futils_a4723d7c95b3cd4097755659bf317bb98}{futils::exp2}}(exponent);}
\DoxyCodeLine{00221\ \ \ \ \ \ \ smooth\_mult\ =\ smooth\_mult\ \&\ smooth\_mask;}
\DoxyCodeLine{00222\ \ \ \ \ \ \ current\_amplitude\ =\ 1.0f;}
\DoxyCodeLine{00223\ \ \ \ \ \}}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}*\ dest\ =\ \mbox{\hyperlink{classvital_1_1_processor_ab09651265a7270548b77e99b1316fde0}{output}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a3f38fe80d632b575a18978456d82b1bfa7938401f18413f9725ea840912e8ba48}{kValue}})-\/>\mbox{\hyperlink{structvital_1_1_output_a1bc2c3a75ee0525ecbfb24fc841b1fe4}{buffer}};}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ current\_hold\_mask;}
\DoxyCodeLine{00228\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ held\_mask\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a87d7df1c91650fe8e4d8ab861cd229dc}{held\_mask\_}};}
\DoxyCodeLine{00229\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_int}}\ trigger\_sample\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a525365c768b97a3a7303df00686462f8}{trigger\_sample\_}};}
\DoxyCodeLine{00230\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}};}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_samples;\ ++i)\ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ delay\_time\_passed\ +=\ tick\_time;}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ past\_delay\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_a1bea6a867419c6ea42ffc195f35ec3bc}{poly\_float::greaterThanOrEqual}}(delay\_time\_passed,\ delay\_time);}
\DoxyCodeLine{00235\ \ \ \ \ \ \ current\_amplitude\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a13a19cf68aa11afa58de96f14442003a}{utils::clamp}}(current\_amplitude\ +\ (fade\_increase\ \&\ past\_delay\_mask),\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \ \ \ \ current\_hold\_mask\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(current\_hold\_mask,\ held\_mask,\ \mbox{\hyperlink{structvital_1_1poly__int_aba1a4192cda895a71f1928a9037d179f}{poly\_int::equal}}(i,\ trigger\_sample));}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ max\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(1.0f,\ current\_phase,\ current\_hold\_mask);}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aaf601c51856a2a33ecf3dc39f2875271}{getValueAtPhase}}(lfo\_buffer,\ resolution,\ max\_index,\ current\_offset);}
\DoxyCodeLine{00240\ \ \ \ \ \ \ current\_value\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ae1ebe307e6064bb3d3bf55a2258d308a}{utils::interpolate}}(value,\ current\_value,\ smooth\_mult);}
\DoxyCodeLine{00241\ \ \ \ \ \ \ dest[i]\ =\ current\_amplitude\ *\ current\_value;}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \ \ \ \ \ \ current\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(current\_offset\ +\ (delta\_offset\ \&\ past\_delay\_mask),\ max);}
\DoxyCodeLine{00244\ \ \ \ \ \ \ current\_phase\ +=\ delta\_phase;}
\DoxyCodeLine{00245\ \ \ \ \ \}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}}\ =\ current\_value;}
\DoxyCodeLine{00248\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}}\ =\ current\_amplitude;}
\DoxyCodeLine{00249\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}}\ =\ delay\_time\_passed;}
\DoxyCodeLine{00250\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ last\_max\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(1.0f,\ current\_phase,\ current\_hold\_mask);}
\DoxyCodeLine{00251\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(current\_offset,\ last\_max);}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keywordflow}{return}\ current\_offset;}
\DoxyCodeLine{00253\ \ \ \}}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ \mbox{\hyperlink{classvital_1_1_synth_lfo_ae924bd16db8af52e3451348407331f19}{SynthLfo::processAudioRateLfo}}(\textcolor{keywordtype}{int}\ num\_samples,\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_phase,}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_offset,\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delta\_offset)\ \{}
\DoxyCodeLine{00257\ \ \ \ \ \textcolor{keywordtype}{int}\ lfo\_resolution\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aa356af7e0087e77a572795346bf83dd5}{source\_}}-\/>\mbox{\hyperlink{class_line_generator_ab915f3ee0e673ae1aeabdf39880e2af0}{resolution}}();}
\DoxyCodeLine{00258\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ resolution\ =\ lfo\_resolution;}
\DoxyCodeLine{00259\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_int}}\ max\_index\ =\ lfo\_resolution\ -\/\ 1;}
\DoxyCodeLine{00260\ \ \ \ \ \mbox{\hyperlink{namespacevital_afcc17475a10ef776bbd2f11b64c1ddfb}{mono\_float}}*\ lfo\_buffer\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aa356af7e0087e77a572795346bf83dd5}{source\_}}-\/>\mbox{\hyperlink{class_line_generator_ae1d135bc4fb25f20fc8cd642bafef316}{getCubicInterpolationBuffer}}();}
\DoxyCodeLine{00261\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delta\_phase\ =\ (\mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac4c286d0ef374067a57ad0de8a39ceb3}{phase}}\ -\/\ current\_phase)\ *\ (1.0f\ /\ num\_samples);}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a078f4b6786ff8e332c963f33df8993bf}{kFade}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00264\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a4dcdfb302843d7d6f232d419cafc0582}{kDelay}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ +\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a0ea2c63fff1ab701676dff4880d6561b}{trigger\_delay\_}};}
\DoxyCodeLine{00265\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\_passed\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}};}
\DoxyCodeLine{00266\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_amplitude\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}};}
\DoxyCodeLine{00267\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ tick\_time\ =\ 1.0f\ /\ \mbox{\hyperlink{classvital_1_1_processor_a70822ba483c1a6528f1809621befd4b8}{getSampleRate}}();}
\DoxyCodeLine{00268\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_increase\ =\ tick\_time\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(tick\_time,\ fade\_time);}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ smooth\_mult\ =\ 0.0f;}
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a0d8f679e6a0a8e797e444dace8c9161d}{kSmoothMode}})-\/>at(0)[0])\ \{}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ half\_life\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a40ab1fecfca449df22d138b4193845c1}{kSmoothTime}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ *\ \mbox{\hyperlink{classvital_1_1_synth_lfo_af1f7af59ef94c1ad0536939356a37b04}{kHalfLifeRatio}};}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ smooth\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_afe451ece04ecb9be82648c49c4e27e7b}{poly\_float::greaterThan}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ exponent\ =\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}(-\/tick\_time)\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00275\ \ \ \ \ \ \ smooth\_mult\ =\ \mbox{\hyperlink{namespacevital_1_1futils_a4723d7c95b3cd4097755659bf317bb98}{futils::exp2}}(exponent);}
\DoxyCodeLine{00276\ \ \ \ \ \ \ smooth\_mult\ =\ smooth\_mult\ \&\ smooth\_mask;}
\DoxyCodeLine{00277\ \ \ \ \ \ \ current\_amplitude\ =\ 1.0f;}
\DoxyCodeLine{00278\ \ \ \ \ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ delaying\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_afe451ece04ecb9be82648c49c4e27e7b}{poly\_float::greaterThan}}(delay\_time,\ delay\_time\_passed);}
\DoxyCodeLine{00281\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}*\ dest\ =\ \mbox{\hyperlink{classvital_1_1_processor_ab09651265a7270548b77e99b1316fde0}{output}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a3f38fe80d632b575a18978456d82b1bfa7938401f18413f9725ea840912e8ba48}{kValue}})-\/>\mbox{\hyperlink{structvital_1_1_output_a1bc2c3a75ee0525ecbfb24fc841b1fe4}{buffer}};}
\DoxyCodeLine{00282\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ phased\_offset\ =\ 0.0f;}
\DoxyCodeLine{00283\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}};}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_samples;\ ++i)\ \{}
\DoxyCodeLine{00286\ \ \ \ \ \ \ delay\_time\_passed\ +=\ tick\_time;}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ past\_delay\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_a1bea6a867419c6ea42ffc195f35ec3bc}{poly\_float::greaterThanOrEqual}}(delay\_time\_passed,\ delay\_time);}
\DoxyCodeLine{00288\ \ \ \ \ \ \ current\_amplitude\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a13a19cf68aa11afa58de96f14442003a}{utils::clamp}}(current\_amplitude\ +\ (fade\_increase\ \&\ past\_delay\_mask),\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \ \ \ \ phased\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a02cebee05a6ccafbce870a1a18ae0d04}{utils::mod}}(current\_offset\ +\ current\_phase);}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aaf601c51856a2a33ecf3dc39f2875271}{getValueAtPhase}}(lfo\_buffer,\ resolution,\ max\_index,\ phased\_offset);}
\DoxyCodeLine{00292\ \ \ \ \ \ \ current\_value\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ae1ebe307e6064bb3d3bf55a2258d308a}{utils::interpolate}}(value,\ current\_value,\ smooth\_mult);}
\DoxyCodeLine{00293\ \ \ \ \ \ \ dest[i]\ =\ current\_amplitude\ *\ current\_value;}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \ \ current\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a02cebee05a6ccafbce870a1a18ae0d04}{utils::mod}}(current\_offset\ +\ (delta\_offset\ \&\ past\_delay\_mask));}
\DoxyCodeLine{00296\ \ \ \ \ \ \ current\_phase\ +=\ delta\_phase;}
\DoxyCodeLine{00297\ \ \ \ \ \}}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}}\ =\ current\_value;}
\DoxyCodeLine{00300\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}}\ =\ current\_amplitude;}
\DoxyCodeLine{00301\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}}\ =\ delay\_time\_passed;}
\DoxyCodeLine{00302\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ undelayed\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a02cebee05a6ccafbce870a1a18ae0d04}{utils::mod}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ +\ delta\_offset\ *\ num\_samples);}
\DoxyCodeLine{00303\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(undelayed\_offset,\ current\_offset,\ delaying\_mask);}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{keywordflow}{return}\ phased\_offset;}
\DoxyCodeLine{00305\ \ \ \}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a65acc01affd4c7d108be79a09d99e2df}{SynthLfo::processAudioRateLoopPoint}}(\textcolor{keywordtype}{int}\ num\_samples,\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_phase,}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_offset,\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delta\_offset)\ \{}
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keywordtype}{int}\ lfo\_resolution\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aa356af7e0087e77a572795346bf83dd5}{source\_}}-\/>\mbox{\hyperlink{class_line_generator_ab915f3ee0e673ae1aeabdf39880e2af0}{resolution}}();}
\DoxyCodeLine{00310\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ resolution\ =\ lfo\_resolution;}
\DoxyCodeLine{00311\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_int}}\ max\_index\ =\ lfo\_resolution\ -\/\ 1;}
\DoxyCodeLine{00312\ \ \ \ \ \mbox{\hyperlink{namespacevital_afcc17475a10ef776bbd2f11b64c1ddfb}{mono\_float}}*\ lfo\_buffer\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aa356af7e0087e77a572795346bf83dd5}{source\_}}-\/>\mbox{\hyperlink{class_line_generator_ae1d135bc4fb25f20fc8cd642bafef316}{getCubicInterpolationBuffer}}();}
\DoxyCodeLine{00313\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delta\_phase\ =\ (\mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac4c286d0ef374067a57ad0de8a39ceb3}{phase}}\ -\/\ current\_phase)\ *\ (1.0f\ /\ num\_samples);}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a078f4b6786ff8e332c963f33df8993bf}{kFade}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00316\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a4dcdfb302843d7d6f232d419cafc0582}{kDelay}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ +\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a0ea2c63fff1ab701676dff4880d6561b}{trigger\_delay\_}};}
\DoxyCodeLine{00317\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\_passed\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}};}
\DoxyCodeLine{00318\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_amplitude\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}};}
\DoxyCodeLine{00319\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ tick\_time\ =\ 1.0f\ /\ \mbox{\hyperlink{classvital_1_1_processor_a70822ba483c1a6528f1809621befd4b8}{getSampleRate}}();}
\DoxyCodeLine{00320\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_increase\ =\ tick\_time\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(tick\_time,\ fade\_time);}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ smooth\_mult\ =\ 0.0f;}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a0d8f679e6a0a8e797e444dace8c9161d}{kSmoothMode}})-\/>at(0)[0])\ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ half\_life\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a40ab1fecfca449df22d138b4193845c1}{kSmoothTime}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ *\ \mbox{\hyperlink{classvital_1_1_synth_lfo_af1f7af59ef94c1ad0536939356a37b04}{kHalfLifeRatio}};}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ smooth\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_afe451ece04ecb9be82648c49c4e27e7b}{poly\_float::greaterThan}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ exponent\ =\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}(-\/tick\_time)\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00327\ \ \ \ \ \ \ smooth\_mult\ =\ \mbox{\hyperlink{namespacevital_1_1futils_a4723d7c95b3cd4097755659bf317bb98}{futils::exp2}}(exponent);}
\DoxyCodeLine{00328\ \ \ \ \ \ \ smooth\_mult\ =\ smooth\_mult\ \&\ smooth\_mask;}
\DoxyCodeLine{00329\ \ \ \ \ \ \ current\_amplitude\ =\ 1.0f;}
\DoxyCodeLine{00330\ \ \ \ \ \}}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}*\ dest\ =\ \mbox{\hyperlink{classvital_1_1_processor_ab09651265a7270548b77e99b1316fde0}{output}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a3f38fe80d632b575a18978456d82b1bfa7938401f18413f9725ea840912e8ba48}{kValue}})-\/>\mbox{\hyperlink{structvital_1_1_output_a1bc2c3a75ee0525ecbfb24fc841b1fe4}{buffer}};}
\DoxyCodeLine{00333\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}};}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_samples;\ ++i)\ \{}
\DoxyCodeLine{00336\ \ \ \ \ \ \ delay\_time\_passed\ +=\ tick\_time;}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ past\_delay\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_a1bea6a867419c6ea42ffc195f35ec3bc}{poly\_float::greaterThanOrEqual}}(delay\_time\_passed,\ delay\_time);}
\DoxyCodeLine{00338\ \ \ \ \ \ \ current\_amplitude\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a13a19cf68aa11afa58de96f14442003a}{utils::clamp}}(current\_amplitude\ +\ (fade\_increase\ \&\ past\_delay\_mask),\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ \ \ \ \ \ \ current\_offset\ +=\ delta\_offset\ \&\ past\_delay\_mask;}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ over\ =\ \mbox{\hyperlink{structvital_1_1poly__float_a1bea6a867419c6ea42ffc195f35ec3bc}{poly\_float::greaterThanOrEqual}}(current\_offset,\ 1.0f);}
\DoxyCodeLine{00342\ \ \ \ \ \ \ current\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(\mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(current\_offset,\ current\_offset\ -\/\ 1.0f\ +\ current\_phase,\ over),\ 1.0f);}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aaf601c51856a2a33ecf3dc39f2875271}{getValueAtPhase}}(lfo\_buffer,\ resolution,\ max\_index,\ current\_offset);}
\DoxyCodeLine{00344\ \ \ \ \ \ \ current\_value\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ae1ebe307e6064bb3d3bf55a2258d308a}{utils::interpolate}}(value,\ current\_value,\ smooth\_mult);}
\DoxyCodeLine{00345\ \ \ \ \ \ \ dest[i]\ =\ current\_amplitude\ *\ current\_value;}
\DoxyCodeLine{00346\ \ \ \ \ \ \ current\_phase\ +=\ delta\_phase;}
\DoxyCodeLine{00347\ \ \ \ \ \}}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}}\ =\ current\_value;}
\DoxyCodeLine{00350\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}}\ =\ current\_amplitude;}
\DoxyCodeLine{00351\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}}\ =\ delay\_time\_passed;}
\DoxyCodeLine{00352\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ current\_offset;}
\DoxyCodeLine{00353\ \ \ \ \ \textcolor{keywordflow}{return}\ current\_offset;}
\DoxyCodeLine{00354\ \ \ \}}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aea95b28c86f5212a5c4bf615a59899c0}{SynthLfo::processAudioRateLoopHold}}(\textcolor{keywordtype}{int}\ num\_samples,\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_phase,}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_offset,\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delta\_offset)\ \{}
\DoxyCodeLine{00358\ \ \ \ \ \textcolor{keywordtype}{int}\ lfo\_resolution\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aa356af7e0087e77a572795346bf83dd5}{source\_}}-\/>\mbox{\hyperlink{class_line_generator_ab915f3ee0e673ae1aeabdf39880e2af0}{resolution}}();}
\DoxyCodeLine{00359\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ resolution\ =\ lfo\_resolution;}
\DoxyCodeLine{00360\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_int}}\ max\_index\ =\ lfo\_resolution\ -\/\ 1;}
\DoxyCodeLine{00361\ \ \ \ \ \mbox{\hyperlink{namespacevital_afcc17475a10ef776bbd2f11b64c1ddfb}{mono\_float}}*\ lfo\_buffer\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aa356af7e0087e77a572795346bf83dd5}{source\_}}-\/>\mbox{\hyperlink{class_line_generator_ae1d135bc4fb25f20fc8cd642bafef316}{getCubicInterpolationBuffer}}();}
\DoxyCodeLine{00362\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delta\_phase\ =\ (\mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac4c286d0ef374067a57ad0de8a39ceb3}{phase}}\ -\/\ current\_phase)\ *\ (1.0f\ /\ num\_samples);}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a078f4b6786ff8e332c963f33df8993bf}{kFade}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00365\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a4dcdfb302843d7d6f232d419cafc0582}{kDelay}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ +\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a0ea2c63fff1ab701676dff4880d6561b}{trigger\_delay\_}};}
\DoxyCodeLine{00366\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\_passed\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}};}
\DoxyCodeLine{00367\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_amplitude\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}};}
\DoxyCodeLine{00368\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ tick\_time\ =\ 1.0f\ /\ \mbox{\hyperlink{classvital_1_1_processor_a70822ba483c1a6528f1809621befd4b8}{getSampleRate}}();}
\DoxyCodeLine{00369\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_increase\ =\ tick\_time\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(tick\_time,\ fade\_time);}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ smooth\_mult\ =\ 0.0f;}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a0d8f679e6a0a8e797e444dace8c9161d}{kSmoothMode}})-\/>at(0)[0])\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ half\_life\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a40ab1fecfca449df22d138b4193845c1}{kSmoothTime}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ *\ \mbox{\hyperlink{classvital_1_1_synth_lfo_af1f7af59ef94c1ad0536939356a37b04}{kHalfLifeRatio}};}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ smooth\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_afe451ece04ecb9be82648c49c4e27e7b}{poly\_float::greaterThan}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ exponent\ =\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}(-\/tick\_time)\ /\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(half\_life,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1dc377770962ad8fa8ef59b6ce3be297}{kMinHalfLife}});}
\DoxyCodeLine{00376\ \ \ \ \ \ \ smooth\_mult\ =\ \mbox{\hyperlink{namespacevital_1_1futils_a4723d7c95b3cd4097755659bf317bb98}{futils::exp2}}(exponent);}
\DoxyCodeLine{00377\ \ \ \ \ \ \ smooth\_mult\ =\ smooth\_mult\ \&\ smooth\_mask;}
\DoxyCodeLine{00378\ \ \ \ \ \ \ current\_amplitude\ =\ 1.0f;}
\DoxyCodeLine{00379\ \ \ \ \ \}}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}*\ dest\ =\ \mbox{\hyperlink{classvital_1_1_processor_ab09651265a7270548b77e99b1316fde0}{output}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a3f38fe80d632b575a18978456d82b1bfa7938401f18413f9725ea840912e8ba48}{kValue}})-\/>\mbox{\hyperlink{structvital_1_1_output_a1bc2c3a75ee0525ecbfb24fc841b1fe4}{buffer}};}
\DoxyCodeLine{00382\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ held\_mask\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a87d7df1c91650fe8e4d8ab861cd229dc}{held\_mask\_}};}
\DoxyCodeLine{00383\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}};}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_samples;\ ++i)\ \{}
\DoxyCodeLine{00386\ \ \ \ \ \ \ delay\_time\_passed\ +=\ tick\_time;}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ past\_delay\_mask\ =\ \mbox{\hyperlink{structvital_1_1poly__float_a1bea6a867419c6ea42ffc195f35ec3bc}{poly\_float::greaterThanOrEqual}}(delay\_time\_passed,\ delay\_time);}
\DoxyCodeLine{00388\ \ \ \ \ \ \ current\_amplitude\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a13a19cf68aa11afa58de96f14442003a}{utils::clamp}}(current\_amplitude\ +\ (fade\_increase\ \&\ past\_delay\_mask),\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \ \ current\_offset\ +=\ delta\_offset\ \&\ past\_delay\_mask;}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__int}{poly\_mask}}\ over\ =\ held\_mask\ \&\ \mbox{\hyperlink{structvital_1_1poly__float_a1bea6a867419c6ea42ffc195f35ec3bc}{poly\_float::greaterThanOrEqual}}(current\_offset,\ current\_phase);}
\DoxyCodeLine{00392\ \ \ \ \ \ \ current\_offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a5b6ee09220fec012fc1597235e4c50e3}{utils::min}}(\mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(current\_offset,\ current\_offset\ -\/\ current\_phase,\ over),\ 1.0f);}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ value\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aaf601c51856a2a33ecf3dc39f2875271}{getValueAtPhase}}(lfo\_buffer,\ resolution,\ max\_index,\ current\_offset);}
\DoxyCodeLine{00394\ \ \ \ \ \ \ current\_value\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ae1ebe307e6064bb3d3bf55a2258d308a}{utils::interpolate}}(value,\ current\_value,\ smooth\_mult);}
\DoxyCodeLine{00395\ \ \ \ \ \ \ dest[i]\ =\ current\_amplitude\ *\ current\_value;}
\DoxyCodeLine{00396\ \ \ \ \ \ \ current\_phase\ +=\ delta\_phase;}
\DoxyCodeLine{00397\ \ \ \ \ \}}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_aa781e0a171a7e66d3744e071487920f9}{smooth\_value}}\ =\ current\_value;}
\DoxyCodeLine{00400\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac372cf8fde4dd7b7adc5eeb68d38ed70}{fade\_amplitude}}\ =\ current\_amplitude;}
\DoxyCodeLine{00401\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a8e54e787bc659360073194bd7012ac5e}{delay\_time\_passed}}\ =\ delay\_time\_passed;}
\DoxyCodeLine{00402\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}}\ =\ current\_offset;}
\DoxyCodeLine{00403\ \ \ \ \ \textcolor{keywordflow}{return}\ current\_offset;}
\DoxyCodeLine{00404\ \ \ \}}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1d865f7458034c4d6d0456a069b045b6}{SynthLfo::processAudioRate}}(\textcolor{keywordtype}{int}\ num\_samples)\ \{}
\DoxyCodeLine{00407\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ fade\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a078f4b6786ff8e332c963f33df8993bf}{kFade}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00408\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delay\_time\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a4dcdfb302843d7d6f232d419cafc0582}{kDelay}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ stereo\_phase\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3aa40c2e85855811725a3ab1d41e756617}{kStereoPhase}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00411\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ current\_phase\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac4c286d0ef374067a57ad0de8a39ceb3}{phase}};}
\DoxyCodeLine{00412\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac4c286d0ef374067a57ad0de8a39ceb3}{phase}}\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a009ee6d6a034db70afa98bf3513867a0}{kPhase}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)\ +\ stereo\_phase\ *\ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}(0.5f,\ -\/0.5f);}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ \ \ \ \ \textcolor{keywordtype}{int}\ sync\_type\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a61ddd9fa63f13f4e623d50667f1891dd}{kSyncType}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0)[0];}
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5acea3e4621da38a094b89a53e82287a56751}{kSustainEnvelope}})}
\DoxyCodeLine{00416\ \ \ \ \ \ \ current\_phase\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(current\_phase,\ 0.0f,\ \mbox{\hyperlink{classvital_1_1_processor_a7fed5dc3ae95e104c71f7ce7f570fab4}{getResetMask}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3afaa4337a97069200731696d42c7a2956}{kNoteTrigger}}));}
\DoxyCodeLine{00417\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00418\ \ \ \ \ \ \ current\_phase\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ace9619cc7eac91b3abdcd77011b1ecb3}{utils::maskLoad}}(current\_phase,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_ac4c286d0ef374067a57ad0de8a39ceb3}{phase}},\ \mbox{\hyperlink{classvital_1_1_processor_a7fed5dc3ae95e104c71f7ce7f570fab4}{getResetMask}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3afaa4337a97069200731696d42c7a2956}{kNoteTrigger}}));}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ frequency\ =\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3a5c128d04b5aa3ddc38fd5c7f2be27c4b}{kFrequency}})-\/>\mbox{\hyperlink{structvital_1_1_input_a8b744f4bd880c0262465eceb8d63d268}{at}}(0);}
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keywordtype}{float}\ tick\_time\ =\ 1.0f\ /\ \mbox{\hyperlink{classvital_1_1_processor_a70822ba483c1a6528f1809621befd4b8}{getSampleRate}}();}
\DoxyCodeLine{00422\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ delta\_offset\ =\ frequency\ *\ tick\_time;}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ output\_phase\ =\ 0.0f;}
\DoxyCodeLine{00425\ \ \ \ \ \mbox{\hyperlink{structvital_1_1poly__float}{poly\_float}}\ offset\ =\ \mbox{\hyperlink{namespacevital_1_1utils_ab453d9dff7b875976c8c8e22047a8558}{utils::max}}(0.0f,\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}.\mbox{\hyperlink{structvital_1_1_synth_lfo_1_1_lfo_state_a74cd709cc282b304705b26a620f02628}{offset}});}
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5acea303458fc9c7cca09b5e9a9c9a63775af}{kEnvelope}})}
\DoxyCodeLine{00427\ \ \ \ \ \ \ output\_phase\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_ada21195dee79f216ee82d7f2cd8b8c48}{processAudioRateEnvelope}}(num\_samples,\ current\_phase,\ offset,\ delta\_offset);}
\DoxyCodeLine{00428\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5acea3e4621da38a094b89a53e82287a56751}{kSustainEnvelope}})}
\DoxyCodeLine{00429\ \ \ \ \ \ \ output\_phase\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a08279a0a2065c114057fe6ac34d84d02}{processAudioRateSustainEnvelope}}(num\_samples,\ current\_phase,\ offset,\ delta\_offset);}
\DoxyCodeLine{00430\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5aceae6d13fd29435f2a82282c52f25fa2834}{kTrigger}}\ ||\ sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5acea765ee0eb550e790ce42deda95a2d36f9}{kSync}})}
\DoxyCodeLine{00431\ \ \ \ \ \ \ output\_phase\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_ae924bd16db8af52e3451348407331f19}{processAudioRateLfo}}(num\_samples,\ current\_phase,\ offset,\ delta\_offset);}
\DoxyCodeLine{00432\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5aceaca607d5cc7f3a8b9f0c3dcd0d3ad1023}{kLoopPoint}})}
\DoxyCodeLine{00433\ \ \ \ \ \ \ output\_phase\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a65acc01affd4c7d108be79a09d99e2df}{processAudioRateLoopPoint}}(num\_samples,\ current\_phase,\ offset,\ delta\_offset);}
\DoxyCodeLine{00434\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (sync\_type\ ==\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a9ff196461f651bb7c277c6523dba5aceaec4e192355f4257ad98e459f4a48e62d}{kLoopHold}})}
\DoxyCodeLine{00435\ \ \ \ \ \ \ output\_phase\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_aea95b28c86f5212a5c4bf615a59899c0}{processAudioRateLoopHold}}(num\_samples,\ current\_phase,\ offset,\ delta\_offset);}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_processor_ab09651265a7270548b77e99b1316fde0}{output}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a3f38fe80d632b575a18978456d82b1bfac4e4a6341414bac59c762e5bc705bdbe}{kOscPhase}})-\/>\mbox{\hyperlink{structvital_1_1_output_a1bc2c3a75ee0525ecbfb24fc841b1fe4}{buffer}}[0]\ =\ \mbox{\hyperlink{namespacevital_1_1utils_a2a2de508f71ee1a987ec75a77b7129b0}{utils::encodePhaseAndVoice}}(output\_phase,\ \mbox{\hyperlink{classvital_1_1_processor_a6785b9361f8b2fd7638c6a02483ec9eb}{input}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_afbb7edad75b65ed2d530b00f45b31dc3aeea02e5e2586399125a0206c86ca26ed}{kNoteCount}})-\/>at(0));}
\DoxyCodeLine{00438\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_processor_ab09651265a7270548b77e99b1316fde0}{output}}(\mbox{\hyperlink{classvital_1_1_synth_lfo_a3f38fe80d632b575a18978456d82b1bfac99f38d8ae36f32b68c986b9ab5c3bce}{kOscFrequency}})-\/>\mbox{\hyperlink{structvital_1_1_output_a1bc2c3a75ee0525ecbfb24fc841b1fe4}{buffer}}[0]\ =\ frequency;}
\DoxyCodeLine{00439\ \ \ \}}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00441\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a121f2af8afbd6db964b8fd1bb96388fe}{SynthLfo::process}}(\textcolor{keywordtype}{int}\ num\_samples)\ \{}
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{keywordtype}{bool}\ control\_rate\ =\ \mbox{\hyperlink{classvital_1_1_processor_a7c412df809f6c84fe54bdd977681fd9a}{isControlRate}}();}
\DoxyCodeLine{00449\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classvital_1_1_synth_lfo_ae36c55e17ebfab423aa2867c18692b6f}{was\_control\_rate\_}}\ \&\&\ !control\_rate)}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a07348b24b2b14c308f1827e6d9c3c36a}{audio\_rate\_state\_}}\ =\ \mbox{\hyperlink{classvital_1_1_synth_lfo_ad04d7f4302c902bb37838051cf617b16}{control\_rate\_state\_}};}
\DoxyCodeLine{00451\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_ae36c55e17ebfab423aa2867c18692b6f}{was\_control\_rate\_}}\ =\ control\_rate;}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a05b435039f626a51d50f120c492ebdf7}{processTrigger}}();}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ \ \ \ \ \textcolor{keywordflow}{if}\ (!control\_rate)}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a1d865f7458034c4d6d0456a069b045b6}{processAudioRate}}(num\_samples);}
\DoxyCodeLine{00457\ \ \ \ \ \mbox{\hyperlink{classvital_1_1_synth_lfo_a761aa70deb09f68ce37bd7e66fe490b1}{processControlRate}}(num\_samples);}
\DoxyCodeLine{00458\ \ \ \}}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classvital_1_1_synth_lfo_a144ad8e8432db904b59e76fed5e94484}{SynthLfo::correctToTime}}(\textcolor{keywordtype}{double}\ seconds)\ \{}
\DoxyCodeLine{00464\ \ \ \ \ *\mbox{\hyperlink{classvital_1_1_synth_lfo_a461d405497bd529d79f2dbac49770a02}{sync\_seconds\_}}\ =\ seconds;}
\DoxyCodeLine{00465\ \ \ \}}
\DoxyCodeLine{00466\ \}\ \textcolor{comment}{//\ namespace\ vital}}

\end{DoxyCode}
