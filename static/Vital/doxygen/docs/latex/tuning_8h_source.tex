\doxysection{tuning.\+h}
\hypertarget{tuning_8h_source}{}\label{tuning_8h_source}\index{/Users/davidvogel/repos/VitalHelp/src/common/tuning.h@{/Users/davidvogel/repos/VitalHelp/src/common/tuning.h}}
\mbox{\hyperlink{tuning_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{Summary:}}
\DoxyCodeLine{00003\ \textcolor{comment}{The\ Tuning\ class\ provides\ a\ flexible\ microtonal\ tuning\ system\ for\ Vital.\ It\ can\ load\ multiple\ file\ formats,\ define\ custom\ scales,\ and\ set\ reference\ notes\ and\ frequencies.\ The\ code\ handles\ reading\ and\ interpreting\ different\ tuning\ standards\ (Scala,\ Tun),\ as\ well\ as\ mapping\ notes\ via\ keyboard\ mapping\ files.\ This\ allows\ Vital\ users\ to\ easily\ explore\ alternate\ tunings\ beyond\ standard\ equal\ temperament.}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}JuceHeader.h"{}}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{common_8h}{common.h}}"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}json/json.h"{}}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{using\ }\mbox{\hyperlink{line__generator_8h_a0c01dbde6677d7e4769b85716c69c491}{json}}\ =\ nlohmann::json;}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_tuning}{Tuning}}\ \{}
\DoxyCodeLine{00024\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_tuning_a7608a015bc024933cffc9eb9833e527f}{kTuningSize}}\ =\ 2\ *\ \mbox{\hyperlink{namespacevital_a7be9efa423f42230b10924b0f69b3b03}{vital::kMidiSize}};}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_tuning_a117d1feb0ce03713ef29a9639188e55b}{kTuningCenter}}\ =\ \mbox{\hyperlink{namespacevital_a7be9efa423f42230b10924b0f69b3b03}{vital::kMidiSize}};}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{class_tuning}{Tuning}}\ \mbox{\hyperlink{class_tuning_a958a4470fd2c57a0f34769f09144cbfc}{getTuningForFile}}(File\ file);}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{static}\ String\ \mbox{\hyperlink{class_tuning_a412287c91d884fbb50e013babedc01c6}{allFileExtensions}}();}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_tuning_a8975d1798d38a2931b7f9fa1410e77e7}{noteToMidiKey}}(\textcolor{keyword}{const}\ String\&\ note);}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00071\ \ \ \ \ \mbox{\hyperlink{class_tuning_a02fae50199cc274b770b2b612a9676bd}{Tuning}}();}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00078\ \ \ \ \ \mbox{\hyperlink{class_tuning_a02fae50199cc274b770b2b612a9676bd}{Tuning}}(File\ file);}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_a965a681fe28238094c92f1f5c4fbd625}{loadScale}}(std::vector<float>\ scale);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_a901f61466d9017fa4913b853e57c8648}{loadFile}}(File\ file);}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_a7bf18cbe84282231d38b8125b0f1b0e7}{setConstantTuning}}(\textcolor{keywordtype}{float}\ note);}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_ab2b239b203c45c353ac94741e4af7dde}{setDefaultTuning}}();}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{namespacevital_afcc17475a10ef776bbd2f11b64c1ddfb}{vital::mono\_float}}\ \mbox{\hyperlink{class_tuning_ab34205c4e40e8dfa6d1eaca84e2253dc}{convertMidiNote}}(\textcolor{keywordtype}{int}\ note)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_a61ab506d6d1e177d33e76f16dc4c68d9}{setStartMidiNote}}(\textcolor{keywordtype}{int}\ start\_midi\_note)\ \{\ scale\_start\_midi\_note\_\ =\ start\_midi\_note;\ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_a463c891b5248b886e814882947c7bfd8}{setReferenceNote}}(\textcolor{keywordtype}{int}\ reference\_note)\ \{\ reference\_midi\_note\_\ =\ reference\_note;\ \}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_abfe8f2f01e1336ae8806922bbf04876e}{setReferenceFrequency}}(\textcolor{keywordtype}{float}\ frequency);}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_a0459bdd8c0d527bd0fe82e46c5d9e472}{setReferenceNoteFrequency}}(\textcolor{keywordtype}{int}\ midi\_note,\ \textcolor{keywordtype}{float}\ frequency);}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_a2774aa3437b2956d32da5d89076c6c18}{setReferenceRatio}}(\textcolor{keywordtype}{float}\ ratio);}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00157\ \ \ \ \ std::string\ \mbox{\hyperlink{class_tuning_aaca28362363bde96088c9b7f4a4a0122}{getName}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mapping\_name\_.empty())}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tuning\_name\_;}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tuning\_name\_.empty())}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mapping\_name\_;}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tuning\_name\_\ +\ \textcolor{stringliteral}{"{}\ /\ "{}}\ +\ mapping\_name\_;}
\DoxyCodeLine{00163\ \ \ \ \ \}}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_a0414567479e73e21af1d5a249dea8ac8}{setName}}(\textcolor{keyword}{const}\ std::string\&\ name)\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ mapping\_name\_.clear();}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ tuning\_name\_\ =\ name;}
\DoxyCodeLine{00173\ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_tuning_ad6b439473745ee5df8c8c35a23bc30cc}{isDefault}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ default\_;\ \}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00187\ \ \ \ \ \mbox{\hyperlink{line__generator_8h_a0c01dbde6677d7e4769b85716c69c491}{json}}\ \mbox{\hyperlink{class_tuning_a7f1430ef3f49e9d0d39cb8d67fe185fc}{stateToJson}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_af10021a2a5a9aceaf605577314230123}{jsonToState}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{line__generator_8h_a0c01dbde6677d7e4769b85716c69c491}{json}}\&\ data);}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_a8130fffbb0f24aef866bba59a11d6028}{loadScalaFile}}(\textcolor{keyword}{const}\ StringArray\&\ scala\_lines);}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_tuning_a8130fffbb0f24aef866bba59a11d6028}{loadScalaFile}}(File\ scala\_file);}
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{keywordtype}{void}\ loadKeyboardMapFile(File\ kbm\_file);}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keywordtype}{void}\ loadTunFile(File\ tun\_file);}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{keywordtype}{int}\ scale\_start\_midi\_note\_;}
\DoxyCodeLine{00211\ \ \ \ \ \textcolor{keywordtype}{float}\ reference\_midi\_note\_;}
\DoxyCodeLine{00212\ \ \ \ \ std::vector<float>\ scale\_;}
\DoxyCodeLine{00213\ \ \ \ \ std::vector<int>\ keyboard\_mapping\_;}
\DoxyCodeLine{00214\ \ \ \ \ \mbox{\hyperlink{namespacevital_afcc17475a10ef776bbd2f11b64c1ddfb}{vital::mono\_float}}\ tuning\_[\mbox{\hyperlink{class_tuning_a7608a015bc024933cffc9eb9833e527f}{kTuningSize}}];}
\DoxyCodeLine{00215\ \ \ \ \ std::string\ tuning\_name\_;}
\DoxyCodeLine{00216\ \ \ \ \ std::string\ mapping\_name\_;}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keywordtype}{bool}\ default\_;}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \ \ JUCE\_LEAK\_DETECTOR(\mbox{\hyperlink{class_tuning}{Tuning}})}
\DoxyCodeLine{00220\ \};}

\end{DoxyCode}
